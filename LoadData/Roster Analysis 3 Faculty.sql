#############################  UPDATE FACULTY TYPE
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Resident';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='GRADUATE AST-R';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='POSTDOC ASO';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='STUDENT';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='GRADUATE AST-T';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Medical Resident';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='PREDOC FELLOWSHIP';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Postdoctoral Associate';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Graduate Student';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='CHIEF RESIDENT';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='STUDENT ASST';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='GRADUATE AST-G';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='ADJ CLIN POSTDOC ASO';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Resident Physician';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Clinical Research Assistant';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Graduate Research Assistant';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Post Doctoral Associate';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Medical Student';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Graduate Assistant';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='GRADUATE RES AST';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Fellow';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='GRAD ASST - R';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='GRAD ASST - T';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Post Doc Associate';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Postdoctoral Fellow';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Intern (OPS)';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Postdoc Associate';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='GRADUATE TCH ASO';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='GRADUATE TCH AST';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Intern';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='NRA SCHOLARSHIP RECIPIENT';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Ph.D.';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='PhD Student';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Post-doctoral Fellow';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Res/Fellowship Prog Assistant';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Research Scholar';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Resident/Fellow';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Pediatric Resident';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Post Doc';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='POST DOC ASO';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='MSRP PREDOC FELLOWSHIP';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Surgery Resident';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Chief Medical Resident';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Periodontics Resident';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Dir, Sports Medicine Fellowship';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Maternal Fetal Medicine Fellow';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Adjunct Clinical Postdoctoral Assoc';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Adjunct Clinical Postdoctoral Associate';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='dental resident';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Fellow Doctoral Student';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Former MFM Adjunct Clinical Postdoc Aso';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='General Surgery Resident';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Grad Student';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Graduate Assistant - Teaching';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Graduate Researcher';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Graduate Student/ Lab Manager';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Graduate Teaching Associate';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='MD Student';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='MD/PhD Candidate';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='MD-PhD Candidate';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='MD-PhD student';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='MD-PhD Trainee';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='MEDICAL FELLOW';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Neonatal-Perinatal Fellow';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Neonatal-Perinatal Medicine';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Nephrology Research Assistant';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Neurology resident';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='NIH Fogarty Research Fellow';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='NIH/NIDA Postdoctoral Fellow';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='OBGYN Resident';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Orthodontic Resident';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Orthopedic Surgery Resident';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Pediatric Emergency Fellow';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Pediatric Proton Therapy Fellow';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='PGY-1';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='PGY-1 OBGYN Resident';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='PGY2 Pharmacy Resident';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Pharm.D.';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Pharmacy Practice Resident';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='PharmD';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='PhD';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='PhD Candidate';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='PhD Candidate, RSD';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='PhD Student, College of Nursing';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='PhD, FNP-BC';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='PhD.';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Post Doc Assoc';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='post doc fellow';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Post Doc Trainee';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Post doctor';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Post Doctoral Associate (Research)';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Post Doctoral Research Associate';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Post doctoral researcher';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Post Doctorial Associate';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='postdoc';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Post-doc';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Post-Doc Fellow';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='POSTDOC FELLOWSHIP';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Postdoc Research Associate';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Post-Doctoral Associate';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Post-Doctoral Fellow in Urology';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Post-doctoral Research Associate';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='postdoctoral research fellow';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Post-doctoral Research Fellow';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Pre Doc Fellow';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Psychiatry Post Doc Fellow';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Psychiatry Resident';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Resident Clin Pharm';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Resident Physician, General Surgery';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Resident Spec Pharm';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Resident, Anatomic Pathology/PhD';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Senior Graduate Teaching Associate';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Senior Postdoctoral Associate Associate';
UPDATE lookup.roster SET FacType='Trainee' WHERE TITLE='Transfusion Medicine Fellow';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Assistant Scientist';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='AST SCTST';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='ADJ LECTURER';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Senior Biological Scientist';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='SCIENTIST';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Associate Scientist';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='AST SCHOLAR';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='BIO SCIENTIST';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Biological Scientist II';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Biological Scientist III';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Biological Scientist IV';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Psychiatry Fulbright Scholar';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='SR. BIO SCIENTIST';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Sr. Biological Scientist';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Sr. Scientist & Assistant Director';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='ASO SCHOLAR';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='ASO SCIENTIST';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='ASSOC SCHOLAR';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='ASSOC SCIENTIST';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='CLINST&ASTPGDIR';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='CO AST SCTST';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Courtesy Clin Ast Prof';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Courtesy Research Asst Professor';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Departmental Affiliate';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Departmental Associate (Sid Martin)';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Dept. Associate';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Dr';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Dr.';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Lecturer & Program Director';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Medical Scientist II';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Pediatrician';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='PI';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='PRG DIR & ASO IN';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='PRG DIR & AST IN';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='PROGRAM DIRECTOR, ADJUNCT LECTURER';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='RES AST SCTST';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Research Affiliate';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Research Associate';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Research Scientist';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Researcher';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Senior Bilogical Scientist';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='SENIOR BIO SCIENTIST';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Short Term Scholar';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='SR ASO IN';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='SR LECTURER';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Visiting Research Scholar';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Adjunct Clinical PDA';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Adjunct Lecturer';
UPDATE lookup.roster SET FacType='Other Faculty' WHERE TITLE='Adjunct Scholar';



UPDATE lookup.roster SET FacultyType="Junior" WHERE FacType="Other Faculty";
UPDATE lookup.roster SET Faculty="Faculty" WHERE FacType="Other Faculty";

UPDATE lookup.roster SET Faculty="Not Faculty" WHERE FacType="Trainee";
UPDATE lookup.roster SET FacultyType="N/A" WHERE FacType="Trainee";

SELECT distinct FacType from lookup.roster;
Select distinct Faculty from lookup.roster;
Select distinct FacultyType from lookup.roster;

select distinct FacType from lookup.roster where FacultyType is null;

UPDATE lookup.roster SET FacultyType="Senior" WHERE FacType IN ('Professor','Associate Professor');
UPDATE lookup.roster SET FacultyType="Junior" WHERE FacType IN ('Assistant Professor','Other Faculty');
UPDATE lookup.roster SET FacultyType="N/A" WHERE FacType IN ('Non-Faculty');
UPDATE lookup.roster SET FacultyType="Trainee" WHERE FacType IN ('Trainee');

SELECT TITLE,FacType from lookup.roster where FacType="Trainee" group by TITLE,FacType ;
#################################################################################
#### CREATE PROGRAM REPORT
#################################################################################
## REPORTING CATEGORY
SET SQL_SAFE_UPDATES = 0;

ALTER TABLE lookup.roster ADD Rept_Program varchar(45);

UPDATE lookup.roster SET Rept_Program='Coordinator Development' WHERE STD_PROGRAM='Academcy for Research Excellence';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='Aging CRU';
UPDATE lookup.roster SET Rept_Program='BERD' WHERE STD_PROGRAM='BERD';
UPDATE lookup.roster SET Rept_Program='BioInformatics' WHERE STD_PROGRAM='BioInformatics';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='Biobehavioral';
UPDATE lookup.roster SET Rept_Program='Biorepository' WHERE STD_PROGRAM='Biorepository';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='CCTR';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='CTRB_Investigators';
UPDATE lookup.roster SET Rept_Program='CTS IT' WHERE STD_PROGRAM='CTS IT';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='CTSI Administration';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='Cancer CRU';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='Cardiovascular CRU';
UPDATE lookup.roster SET Rept_Program='Cellular Reprogramming' WHERE STD_PROGRAM='Cellular Reprogramming';
UPDATE lookup.roster SET Rept_Program='Clinical Research Center' WHERE STD_PROGRAM='Clinical Research Center';
UPDATE lookup.roster SET Rept_Program='Coordinator Development' WHERE STD_PROGRAM='Clinical Research Professionals Advisory Council';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='ClinicalTrials.GOV';
UPDATE lookup.roster SET Rept_Program='Communications' WHERE STD_PROGRAM='Communications';
UPDATE lookup.roster SET Rept_Program='Healthstreet' WHERE STD_PROGRAM='Community Engagement - Jacksonville';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='Dental CRU';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='Diabetes Center';
UPDATE lookup.roster SET Rept_Program='Regulatory Assistance' WHERE STD_PROGRAM='Ethics Consultation';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='Evaluation';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='GI Liver CRU';
UPDATE lookup.roster SET Rept_Program='Personalized Medicine' WHERE STD_PROGRAM='Genotyping';
UPDATE lookup.roster SET Rept_Program='Healthstreet' WHERE STD_PROGRAM='HealthStreet-Gainesville';
UPDATE lookup.roster SET Rept_Program='Healthstreet' WHERE STD_PROGRAM='HealthStreet-Jacksonville';
UPDATE lookup.roster SET Rept_Program='Human Imaging' WHERE STD_PROGRAM='Human Imaging';
UPDATE lookup.roster SET Rept_Program='Implementation Science' WHERE STD_PROGRAM='Implementation Science';
UPDATE lookup.roster SET Rept_Program='Integrated Data Repository' WHERE STD_PROGRAM='Integrated Data Repository';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='Jacksonville  CRU';
UPDATE lookup.roster SET Rept_Program='K College' WHERE STD_PROGRAM='K College';
UPDATE lookup.roster SET Rept_Program='KL TL' WHERE STD_PROGRAM='KL TL';
UPDATE lookup.roster SET Rept_Program='Tranlational Workforce Development' WHERE STD_PROGRAM='MS CTS';
UPDATE lookup.roster SET Rept_Program='Mentor Academy' WHERE STD_PROGRAM='Mentor';
UPDATE lookup.roster SET Rept_Program='Metabolomics' WHERE STD_PROGRAM='Metabolomics';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='Neuromedicine CRU';
UPDATE lookup.roster SET Rept_Program='One Florida' WHERE STD_PROGRAM='One Florida';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='Pain CRU';
UPDATE lookup.roster SET Rept_Program='Personalized Medicine' WHERE STD_PROGRAM='Personalized Medicine';
UPDATE lookup.roster SET Rept_Program='Pilot Awards' WHERE STD_PROGRAM='Pilot Awards';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='PubMed Compliance';
UPDATE lookup.roster SET Rept_Program='Regulatory Assistance' WHERE STD_PROGRAM='Quality Assurance';
UPDATE lookup.roster SET Rept_Program='Regulatory Assistance' WHERE STD_PROGRAM='RAC';
UPDATE lookup.roster SET Rept_Program='REDCap' WHERE STD_PROGRAM='REDCap';
UPDATE lookup.roster SET Rept_Program='Recruitment Center' WHERE STD_PROGRAM='Recruitment Center';
UPDATE lookup.roster SET Rept_Program='Regulatory Assistance' WHERE STD_PROGRAM='Regulatory Assistance';
UPDATE lookup.roster SET Rept_Program='Coordinator Development' WHERE STD_PROGRAM='Research Coordinator Consortium';
UPDATE lookup.roster SET Rept_Program='Research Subject Advocate' WHERE STD_PROGRAM='Research Subject Advocate';
UPDATE lookup.roster SET Rept_Program='Clinical Research Center' WHERE STD_PROGRAM='Service Center';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='Simulation Center';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='Sleep CRU';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='Study Registry';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='StudyConnect';
UPDATE lookup.roster SET Rept_Program='Tranlational Workforce Development' WHERE STD_PROGRAM='TPDP';
UPDATE lookup.roster SET Rept_Program='Tranlational Workforce Development' WHERE STD_PROGRAM='TRACTS';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='Tuberculosis PH CRU';
UPDATE lookup.roster SET Rept_Program='OMIT' WHERE STD_PROGRAM='UNDEFINED';

ALTER TABLE lookup.roster ADD Rept_Program2 varchar(45);

UPDATE lookup.roster SET Rept_Program2='Core Facilities' WHERE STD_PROGRAM='Biobehavioral';
UPDATE lookup.roster SET Rept_Program2='Core Facilities' WHERE STD_PROGRAM='Simulation Center';
UPDATE lookup.roster SET Rept_Program2='Core Facilities' WHERE STD_PROGRAM='Biorepository';
UPDATE lookup.roster SET Rept_Program2='Core Facilities' WHERE STD_PROGRAM='Cellular Reprogramming';
UPDATE lookup.roster SET Rept_Program2='Core Facilities' WHERE STD_PROGRAM='Genotyping';
UPDATE lookup.roster SET Rept_Program2='Core Facilities' WHERE STD_PROGRAM='Human Imaging';
UPDATE lookup.roster SET Rept_Program2='CRUs' WHERE STD_PROGRAM='CCTR';
UPDATE lookup.roster SET Rept_Program2='CRUs' WHERE STD_PROGRAM='Cardiovascular CRU';
UPDATE lookup.roster SET Rept_Program2='CRUs' WHERE STD_PROGRAM='GI Liver CRU';
UPDATE lookup.roster SET Rept_Program2='CRUs' WHERE STD_PROGRAM='Sleep CRU';
UPDATE lookup.roster SET Rept_Program2='CRUs' WHERE STD_PROGRAM='Aging CRU';
UPDATE lookup.roster SET Rept_Program2='CRUs' WHERE STD_PROGRAM='Cancer CRU';
UPDATE lookup.roster SET Rept_Program2='CRUs' WHERE STD_PROGRAM='Dental CRU';
UPDATE lookup.roster SET Rept_Program2='CRUs' WHERE STD_PROGRAM='Diabetes Center';
UPDATE lookup.roster SET Rept_Program2='CRUs' WHERE STD_PROGRAM='Jacksonville  CRU';
UPDATE lookup.roster SET Rept_Program2='CRUs' WHERE STD_PROGRAM='Neuromedicine CRU';
UPDATE lookup.roster SET Rept_Program2='CRUs' WHERE STD_PROGRAM='Pain CRU';
UPDATE lookup.roster SET Rept_Program2='CRUs' WHERE STD_PROGRAM='Tuberculosis PH CRU';
UPDATE lookup.roster SET Rept_Program2='Healthstreet' WHERE STD_PROGRAM='HealthStreet-Gainesville';
UPDATE lookup.roster SET Rept_Program2='Healthstreet' WHERE STD_PROGRAM='HealthStreet-Jacksonville';
UPDATE lookup.roster SET Rept_Program2='Informatics' WHERE STD_PROGRAM='BioInformatics';
UPDATE lookup.roster SET Rept_Program2='CTS IT' WHERE STD_PROGRAM='CTS IT';
UPDATE lookup.roster SET Rept_Program2='Integrated Data Repository' WHERE STD_PROGRAM='Integrated Data Repository';
UPDATE lookup.roster SET Rept_Program2='REDCap' WHERE STD_PROGRAM='REDCap';
UPDATE lookup.roster SET Rept_Program2='Multisite' WHERE STD_PROGRAM='Multisite-TIN';
UPDATE lookup.roster SET Rept_Program2='Multisite' WHERE STD_PROGRAM='One Florida';
UPDATE lookup.roster SET Rept_Program2='OMIT' WHERE STD_PROGRAM='CTRB_Investigators';
UPDATE lookup.roster SET Rept_Program2='OMIT' WHERE STD_PROGRAM='CTSI Administration';
UPDATE lookup.roster SET Rept_Program2='OMIT' WHERE STD_PROGRAM='ClinicalTrials.GOV';
UPDATE lookup.roster SET Rept_Program2='OMIT' WHERE STD_PROGRAM='Evaluation';
UPDATE lookup.roster SET Rept_Program2='OMIT' WHERE STD_PROGRAM='PubMed Compliance';
UPDATE lookup.roster SET Rept_Program2='OMIT' WHERE STD_PROGRAM='Study Registry';
UPDATE lookup.roster SET Rept_Program2='OMIT' WHERE STD_PROGRAM='StudyConnect';
UPDATE lookup.roster SET Rept_Program2='Regulatory Assistance' WHERE STD_PROGRAM='Ethics Consultation';
UPDATE lookup.roster SET Rept_Program2='Regulatory Assistance' WHERE STD_PROGRAM='Quality Assurance';
UPDATE lookup.roster SET Rept_Program2='Regulatory Assistance' WHERE STD_PROGRAM='RAC';
UPDATE lookup.roster SET Rept_Program2='Regulatory Assistance' WHERE STD_PROGRAM='Regulatory Assistance';
UPDATE lookup.roster SET Rept_Program2='Regulatory Assistance' WHERE STD_PROGRAM='Research Subject Advocate';
UPDATE lookup.roster SET Rept_Program2='TWD' WHERE STD_PROGRAM='Academcy for Research Excellence';
UPDATE lookup.roster SET Rept_Program2='TWD' WHERE STD_PROGRAM='Clinical Research Professionals Advisory Council';
UPDATE lookup.roster SET Rept_Program2='TWD' WHERE STD_PROGRAM='K College';
UPDATE lookup.roster SET Rept_Program2='TWD' WHERE STD_PROGRAM='KL TL';
UPDATE lookup.roster SET Rept_Program2='TWD' WHERE STD_PROGRAM='MS CTS';
UPDATE lookup.roster SET Rept_Program2='TWD' WHERE STD_PROGRAM='Mentor';
UPDATE lookup.roster SET Rept_Program2='TWD' WHERE STD_PROGRAM='Research Coordinator Consortium';
UPDATE lookup.roster SET Rept_Program2='TWD' WHERE STD_PROGRAM='TPDP';
UPDATE lookup.roster SET Rept_Program2='TWD' WHERE STD_PROGRAM='TRACTS';
UPDATE lookup.roster SET Rept_Program2='TWD' WHERE STD_PROGRAM='Educational Scholarship Program';
UPDATE lookup.roster SET Rept_Program2='Metabolomics' WHERE STD_PROGRAM='Metabolomics';
UPDATE lookup.roster SET Rept_Program2='Florida State University' WHERE STD_PROGRAM='Florida State University';
UPDATE lookup.roster SET Rept_Program2='Network Science' WHERE STD_PROGRAM='Network Science';
UPDATE lookup.roster SET Rept_Program2='BERD' WHERE STD_PROGRAM='BERD';
UPDATE lookup.roster SET Rept_Program2='Clinical Research Center' WHERE STD_PROGRAM='Clinical Research Center';
UPDATE lookup.roster SET Rept_Program2='Communications' WHERE STD_PROGRAM='Communications';
UPDATE lookup.roster SET Rept_Program2='Community Engagement - Jacksonville' WHERE STD_PROGRAM='Community Engagement - Jacksonville';
UPDATE lookup.roster SET Rept_Program2='Jacksonville Research?' WHERE STD_PROGRAM='Jacksonville Research?';
UPDATE lookup.roster SET Rept_Program2='Implementation Science' WHERE STD_PROGRAM='Implementation Science';
UPDATE lookup.roster SET Rept_Program2='Personalized Medicine' WHERE STD_PROGRAM='Personalized Medicine';
UPDATE lookup.roster SET Rept_Program2='Pilot Awards' WHERE STD_PROGRAM='Pilot Awards';
UPDATE lookup.roster SET Rept_Program2='Recruitment Center' WHERE STD_PROGRAM='Recruitment Center';
UPDATE lookup.roster SET Rept_Program2='Service Center' WHERE STD_PROGRAM='Service Center';
UPDATE lookup.roster SET Rept_Program2='OMIT' WHERE STD_PROGRAM='UNDEFINED';





select distinct STD_PROGRAM from lookup.roster where Rept_Program="";

select distinct STD_PROGRAM from lookup.roster where Rept_Program2="";






#################################################################################
#################################################################################
drop table if exists work.roster;
create table work.roster as select * from lookup.roster;

#################################################################################
drop table if Exists work.ProgTable;
CREATE TABLE work.ProgTable AS
SELECT DISTINCT Rept_Program2 AS Program
FROM work.roster
WHERE Rept_Program2 <>"OMIT";

;

ALTER TABLE work.ProgTable
ADD Users_2009 integer(5),
ADD Users_2010 integer(5),
ADD Users_2011 integer(5),
ADD Users_2012 integer(5),
ADD Users_2013 integer(5),
ADD Users_2014 integer(5),
ADD Users_2015 integer(5),
ADD Users_2016 integer(5),
ADD Users_2017 integer(5),
ADD Users_AllYears integer(5),
ADD Roster_Users_2009 integer(5),
ADD Roster_Users_2010 integer(5),
ADD Roster_Users_2011 integer(5),
ADD Roster_Users_2012 integer(5),
ADD Roster_Users_2013 integer(5),
ADD Roster_Users_2014 integer(5),
ADD Roster_Users_2015 integer(5),
ADD Roster_Users_2016 integer(5),
ADD Roster_Users_2017 integer(5),
ADD Roster_Users_AllYears integer(5);


SET SQL_SAFE_UPDATES = 0;

UPDATE work.ProgTable
SET Users_2009=0,
    Users_2010=0,
    Users_2011=0,
    Users_2012=0,
    Users_2013=0,
    Users_2014=0,
    Users_2015=0,
    Users_2016=0,
    Users_2017=0,
    Users_AllYears=0,
    Roster_Users_2009=0,
    Roster_Users_2010=0,
    Roster_Users_2011=0,
    Roster_Users_2012=0,
    Roster_Users_2013=0,
    Roster_Users_2014=0,
    Roster_Users_2015=0,
    Roster_Users_2016=0,
    Roster_Users_2017=0,
    Roster_Users_AllYears=0;


DROP TABLE IF EXISTS work.progusers;
create table work.progusers AS
select Year,Rept_Program,count(distinct Person_key) AS UndupUsers
from work.roster
group by Year,Rept_Program2;

DROP TABLE IF EXISTS work.progroster;
create table work.progroster AS
select Year,Rept_Program,count(distinct Person_key) AS UndupRoster
from work.roster
where FacType<>"Non-Faculty"
group by Year,Rept_Program2;

DROP TABLE IF EXISTS work.Allusers;
create table work.Allusers AS
select Rept_Program,count(distinct Person_key) AS UndupUsers
from work.roster
group by Rept_Program2;

DROP TABLE IF EXISTS work.Allroster;
create table  work.Allroster AS
select Rept_Program,count(distinct Person_key) AS UndupUsers
from work.roster
Where FacType<>"Non-Faculty"
group by Rept_Program2;



UPDATE work.ProgTable pt, work.progusers lu SET pt.Users_2009=UndupUsers WHERE lu.Year=2009 AND pt.Program=lu.Rept_Program;
UPDATE work.ProgTable pt, work.progusers lu SET pt.Users_2010=UndupUsers WHERE lu.Year=2010 AND pt.Program=lu.Rept_Program;
UPDATE work.ProgTable pt, work.progusers lu SET pt.Users_2011=UndupUsers WHERE lu.Year=2011 AND pt.Program=lu.Rept_Program;
UPDATE work.ProgTable pt, work.progusers lu SET pt.Users_2012=UndupUsers WHERE lu.Year=2012 AND pt.Program=lu.Rept_Program;
UPDATE work.ProgTable pt, work.progusers lu SET pt.Users_2013=UndupUsers WHERE lu.Year=2013 AND pt.Program=lu.Rept_Program;
UPDATE work.ProgTable pt, work.progusers lu SET pt.Users_2014=UndupUsers WHERE lu.Year=2014 AND pt.Program=lu.Rept_Program;
UPDATE work.ProgTable pt, work.progusers lu SET pt.Users_2015=UndupUsers WHERE lu.Year=2015 AND pt.Program=lu.Rept_Program;
UPDATE work.ProgTable pt, work.progusers lu SET pt.Users_2016=UndupUsers WHERE lu.Year=2016 AND pt.Program=lu.Rept_Program;
UPDATE work.ProgTable pt, work.progusers lu SET pt.Users_2017=UndupUsers WHERE lu.Year=2017 AND pt.Program=lu.Rept_Program;
UPDATE work.ProgTable pt, work.Allusers lu SET pt.Users_AllYears=UndupUsers WHERE pt.Program=lu.Rept_Program;

UPDATE work.ProgTable pt, work.progroster lu SET pt.Roster_Users_2009=UndupRoster WHERE lu.Year=2009 AND pt.Program=lu.Rept_Program;
UPDATE work.ProgTable pt, work.progroster lu SET pt.Roster_Users_2010=UndupRoster WHERE lu.Year=2010 AND pt.Program=lu.Rept_Program;
UPDATE work.ProgTable pt, work.progroster lu SET pt.Roster_Users_2011=UndupRoster WHERE lu.Year=2011 AND pt.Program=lu.Rept_Program;
UPDATE work.ProgTable pt, work.progroster lu SET pt.Roster_Users_2012=UndupRoster WHERE lu.Year=2012 AND pt.Program=lu.Rept_Program;
UPDATE work.ProgTable pt, work.progroster lu SET pt.Roster_Users_2013=UndupRoster WHERE lu.Year=2013 AND pt.Program=lu.Rept_Program;
UPDATE work.ProgTable pt, work.progroster lu SET pt.Roster_Users_2014=UndupRoster WHERE lu.Year=2014 AND pt.Program=lu.Rept_Program;
UPDATE work.ProgTable pt, work.progroster lu SET pt.Roster_Users_2015=UndupRoster WHERE lu.Year=2015 AND pt.Program=lu.Rept_Program;
UPDATE work.ProgTable pt, work.progroster lu SET pt.Roster_Users_2016=UndupRoster WHERE lu.Year=2016 AND pt.Program=lu.Rept_Program;
UPDATE work.ProgTable pt, work.progroster lu SET pt.Roster_Users_2017=UndupRoster WHERE lu.Year=2017 AND pt.Program=lu.Rept_Program;
UPDATE work.ProgTable pt, work.Allroster lu SET pt.Roster_Users_AllYears=UndupUsers WHERE pt.Program=lu.Rept_Program;

select * from work.ProgTable;

Drop table if exists results.RosterProgramTable;
CREATE Table results.RosterProgramTable AS
select * from work.ProgTable
ORDER BY Roster_Users_AllYears DESC;

SELECT Program,
Roster_Users_2009,
Roster_Users_2010,
Roster_Users_2011,
Roster_Users_2012,
Roster_Users_2013,
Roster_Users_2014,
Roster_Users_2015,
Roster_Users_2016
from  work.ProgTable;


####################################################################################
select distinct STD_PROGRAM from work.roster;

SELECT Count(Distinct Person_KEY) AS Undup
FROM work.roster
WHERE Roster=1
AND YEAR=2017
AND STD_PROGRAM="BERD";

SELECT Count(Distinct Person_KEY) AS Undup
FROM work.roster
WHERE YEAR=2017
AND STD_PROGRAM="BERD";

SELECT Count(Distinct Person_KEY) AS Undup
FROM work.roster
WHERE Roster=1
AND YEAR IN (2015,2016,2017)
AND STD_PROGRAM="BERD";

SELECT Count(Distinct Person_KEY) AS Undup
FROM work.roster
WHERE YEAR IN (2015,2016,2017)
AND STD_PROGRAM="BERD";



select * from lookup.ufids where UF_USER_NM="edneu";

create table work.faclist as
Select "Non-Faculty",STD_PROGRAM,COunt(Distinct Person_Key) from lookup.roster where FacType="Non-Faculty" GROUP BY "Non-Faculty",STD_PROGRAM;
UNION ALL
Select "Faculty",STD_PROGRAM,COunt(Distinct Person_Key) from lookup.roster where FacType<>"Non-Faculty" GROUP BY "Faculty",STD_PROGRAM;


create table work.faclist as
Select "Non-Faculty",COunt(Distinct Person_Key) from lookup.roster where FacType="Non-Faculty" GROUP BY "Non-Faculty";
UNION ALL
Select "FACULTY",COunt(Distinct Person_Key) from lookup.roster where FacType<>"Non-Faculty" GROUP BY "FACULTY";

####################################################################################
####################################################################################
####################################################################################
####################################################################################
### VERIFY #########################################################################
####################################################################################
############### SENIOR / Junior Indicator


select distinct FacultyType from work.roster;


select distinct Title from work.roster where FacultyType is Null ; 


select distinct Title from work.roster where FacultyType is Null;

select * from lookup.titles_for_roster where Title in (select distinct Title from work.roster where FacultyType is Null);



create table loaddata.roster_bu_20171101 as select * from work.roster;

DROP TABLE IF EXISTS work.titlelist;
create table work.titlelist as
SELECT TITLE,
       FacultyType 
from work.roster
WHERE FacultyType is not Null
GROUP BY TITLE,
       FacultyType;

ALTER TABLE work.roster
ADD Faculty varchar(12);

SET SQL_SAFE_UPDATES = 0;
UPDATE work.roster rs, lookup.faculty_type lu
SET rs.FacultyType=lu.FacultyType,
    rs.Faculty=lu.Faculty
WHERE rs.Title=lu.Title;

select distinct Title from work.roster where FacultyType is Null;
select distinct Title from work.roster where Faculty is Null;

select Year,Faculty,COUNT(DISTINCT Person_KEY) from work.roster where Roster=1 group by Year,Faculty;

select Year,FacultyType,COUNT(DISTINCT Person_KEY) from work.roster where Roster=1 and FacultyType is not Null group by Year,FacultyType;

drop table if exists work.notitle;
create table work.notitle AS
select distinct Person_Key from work.roster where Title="" or Title is Null;

DROP TABLE IF EXISTS work.fixtitle3;
CREATE TABLE work.fixtitle3 AS
SELECT 
UF_UFID AS Person_Key,
UF_DISPLAY_NM,
UF_WORK_TITLE AS Title,
"N/A" AS FacultyType,
"Not Faculty" AS Faculty
FROM lookup.ufids
WHERE UF_UFID IN (select distinct Person_Key from work.roster where Title="" or Title is Null)
AND UF_WORK_TITLE<>"";


SELECT Employee_ID,Job_Code,Salary_Plan from lookup.active_emp
WHERE Employee_ID IN (select distinct Person_Key from work.roster where Title="" or Title is Null);

drop table if exists work.fixtitle;
create Table work.fixtitle AS
select 	Person_Key,
		Title,
		Roster
from work.roster 
where Person_Key in (select distinct Person_Key from work.roster where Title="" or Title is Null)
AND Title<>"" 
AND Title is NOT NULL;



UPDATE work.roster rs, work.fixtitle lu
SET rs.Title=lu.Title
WHERE rs.Person_key=lu.Person_Key
AND (rs.Title="" or rs.Title is Null);

drop table if exists work.fixtitle2;
create Table work.fixtitle2 AS
SELECT Employee_ID AS Person_key,
       Job_Code AS Title,
       Salary_Plan
from lookup.active_emp
WHERE Employee_ID IN (select distinct Person_Key from work.roster where Title="" or Title is Null);

ALTER TABLE work.fixtitle2
ADD Faculty varchar(12);

UPDATE work.fixtitle2 SET Faculty="Not Faculty";

UPDATE work.fixtitle2 
SET Faculty="Faculty"
WHERE Salary_Plan IN ('Salaried Faculty - 12 Month');

SELECT DISTINCT Salary_Plan from work.fixtitle2;



UPDATE work.roster rs, work.fixtitle2 lu
SET rs.Title=lu.Title,
    rs.Faculty=lu.Faculty
WHERE rs.Person_key=lu.Person_Key
AND (rs.Title="" or rs.Title is Null);


UPDATE work.roster rs, work.fixtitle3 lu
SET rs.Title=lu.Title,
    rs.Faculty=lu.Faculty,
    rs.FacultyType=lu.FacultyType
WHERE rs.Person_key=lu.Person_Key
AND (rs.Title="" or rs.Title is Null);
####################################################################################
####################################################################################



####################################################################################
####################################################################################
############ standardize colleges
select DepartmentID,Department,COUNT(*) from work.roster where College="" GROUP BY DepartmentID,Department;
select College,count(*) from work.roster group by College;

SELECT Year,UFID,LastName,FirstName,STD_PROGRAM, count(*) as Num from work.roster where roster=1 and College="" GROUP BY Year,UFID,LastName,FirstName,STD_PROGRAM;

SELECT Year,STD_PROGRAM, count(*) as Num from work.roster where College="" GROUP BY Year,STD_PROGRAM;

SELECT STD_PROGRAM, count(*) as Num from work.roster where College="" AND Roster=1 GROUP BY STD_PROGRAM;
SELECT Year, count(*) as Num from work.roster where College="" AND Roster=1 GROUP BY Year;

select DepartmentID,Department,College,COUNT(*) from work.roster group by DepartmentID,Department,College order by DepartmentID,Department,College ;


select distinct College from lookup.empdeptcoll order by College;

CREATE INDEX Empdept ON lookup.empdeptcoll (Detail_Dept_Code);
/*
UPDATE work.roster wr, lookup.empdeptcoll lu
SET wr.College=lu.College
WHERE wr.DepartmentID=lu.Detail_Dept_Code;


UPDATE work.roster SET College='COLLEGE- AGRICUL / NAT RES' WHERE DEPARTMENT='AG-FPO-ADMINISTRATION';
UPDATE work.roster SET College='COLLEGE-DENTISTRY' WHERE DEPARTMENT='DN-JACKSONVILLE';
UPDATE work.roster SET College='COLLEGE-DENTISTRY' WHERE DEPARTMENT='DN-OFFICE OF EDUCATION';
UPDATE work.roster SET College='COLLEGE-DENTISTRY' WHERE DEPARTMENT='DN-CRANIOFACIAL CENTER';
UPDATE work.roster SET College='COLLEGE-HLTH/HUMAN PERFORMANCE' WHERE DEPARTMENT='HH-APK-ATHLETIC TRAINING';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE DEPARTMENT='MD-RESEARCH ADMIN & COMPLIANCE';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE DEPARTMENT='FLORIDA PROTON INSTITUTE SECUR';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE DEPARTMENT='Health Outcomes and Policy';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE DEPARTMENT='Medicine';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE DEPARTMENT='MD-DERMATOLOGY';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE DEPARTMENT='MD- FAMILY MED AT MAIN';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE DEPARTMENT='MD-HOBI-ONEFLORIDA';
UPDATE work.roster SET College='COLLEGE-MEDICINE JACKSONVILLE' WHERE DEPARTMENT='JX-DEAN-JACKSONVILLE';
UPDATE work.roster SET College='COLLEGE-NURSING' WHERE DEPARTMENT='NR-ASSOC DEAN-ACADEMIC AFFRS';
UPDATE work.roster SET College='COLLEGE-PHARMACY' WHERE DEPARTMENT='PH-DISTANCE-CONTINUING-EXEC ED';
UPDATE work.roster SET College='COLLEGE-PHARMACY' WHERE DEPARTMENT='PH-DCEE-JACKONVILLE';
UPDATE work.roster SET College='COLLEGE-VETERINARY MED' WHERE DEPARTMENT='VM-SA MEDICINE';
UPDATE work.roster SET College='DSO-SHANDS' WHERE DEPARTMENT='DSO-SHANDS UF';
UPDATE work.roster SET College='DSO-SHANDS' WHERE DEPARTMENT='DSO-SHANDS UF PHYSICIANS (UFP)';
UPDATE work.roster SET College='DSO-SHANDS' WHERE DEPARTMENT='DSO-SHANDS JAX CLINICAL PRACT';
UPDATE work.roster SET College='DSO-SHANDS' WHERE DEPARTMENT='DSO-SHANDS REHAB';
UPDATE work.roster SET College='DSO-SHANDS' WHERE DEPARTMENT='DSO-SHANDS JACKSONVILLE (JAX)';
UPDATE work.roster SET College='DSO-SHANDS' WHERE DEPARTMENT='UF HEALTH SHANDS TRAINING';
UPDATE work.roster SET College='DSO-SHANDS' WHERE DEPARTMENT='DSO-SHANDS';


UPDATE work.roster SET College='COLLEGE- AGRICUL / NAT RES' WHERE Department='REGISTRAR STUDENTS' AND College='AG';
UPDATE work.roster SET College='COLLEGE-BUSINESS ADMINSTRATION' WHERE Department='BA-BUREAU-ECON BUS / RES' AND College='BA';
UPDATE work.roster SET College='COLLEGE-BUSINESS ADMINSTRATION' WHERE Department='BA-ECONOMICS-BUSINESS OFFICE' AND College='';
UPDATE work.roster SET College='COLLEGE-DENTISTRY' WHERE Department='DN-PDRC' AND College='DN';
UPDATE work.roster SET College='COLLEGE-DENTISTRY' WHERE Department='DN-DENTAL BIOMATERIALS' AND College='DN';
UPDATE work.roster SET College='COLLEGE-DESIGN CONSTRUC / PLAN' WHERE Department='REGISTRAR STUDENTS' AND College='DS';
UPDATE work.roster SET College='COLLEGE-EDUCATION' WHERE Department='ED-EDP EDUCATIONAL PSYCHOLOGY' AND College='ED';
UPDATE work.roster SET College='COLLEGE-ENGINEERING' WHERE Department='' AND College='EG';
UPDATE work.roster SET College='COLLEGE-ENGINEERING' WHERE Department='EG-PARTICLE ENG RES CTR' AND College='';
UPDATE work.roster SET College='COLLEGE-ENGINEERING' WHERE Department='REGISTRAR STUDENTS' AND College='EG';
UPDATE work.roster SET College='COLLEGE-HLTH/HUMAN PERFORMANCE' WHERE Department='REGISTRAR STUDENTS' AND College='HH';
UPDATE work.roster SET College='COLLEGE-JOURNALISM / COMMUNICA' WHERE Department='REGISTRAR STUDENTS' AND College='COLLEGE-JOURNALISM / COMMUNICA';
UPDATE work.roster SET College='COLLEGE-JOURNALISM / COMMUNICA' WHERE Department='' AND College='CO';
UPDATE work.roster SET College='COLLEGE-LAW' WHERE Department='REGISTRAR STUDENTS' AND College='LW';
UPDATE work.roster SET College='COLLEGE-LIBERAL ARTS/SCIENCES' WHERE Department='LS-CHEMISTRY-GENERAL' AND College='';
UPDATE work.roster SET College='COLLEGE-LIBERAL ARTS/SCIENCES' WHERE Department='LS-MATHEMATICS-GENERAL' AND College='LS';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE Department='Medicine' AND College='COLLEGE-MEDICINE';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE Department='REGISTRAR STUDENTS' AND College='COLLEGE-MEDICINE';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE Department='' AND College='MD';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE Department='MD-PULMONARY MEDICINE' AND College='';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE Department='MD-HEALTH CARE SUMMER INST' AND College='';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE Department='MD-ANESTHESIOLOGY' AND College='MD';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE Department='MD-OBGYN-EDUCATION' AND College='MD';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE Department='MD-PEDS-GLYCOGEN STRG DIS PROG' AND College='MD';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE Department='MD-SURGERY-VASCULAR' AND College='MD';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE Department='MD-RESIDENCY PROGRAM' AND College='';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE Department='MD-BIOSTATS / EPIDEMIOLOGY' AND College='MD';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE Department='MD-CLINICAL RESEARCH CENTER' AND College='Ce';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE Department='MD-CTSI' AND College='MD';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE Department='REGISTRAR STUDENTS' AND College='MC';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE Department='REGISTRAR STUDENTS' AND College='MD';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE Department='REGISTRAR STUDENTS' AND College='Me';
UPDATE work.roster SET College='COLLEGE-MEDICINE JACKSONVILLE' WHERE Department='' AND College='JX';
UPDATE work.roster SET College='COLLEGE-MEDICINE JACKSONVILLE' WHERE Department='REGISTRAR STUDENTS' AND College='JX';
UPDATE work.roster SET College='COLLEGE-PHARMACY' WHERE Department='REGISTRAR STUDENTS' AND College='NR';
UPDATE work.roster SET College='COLLEGE-PUBL HLTH / HLTH PROFS' WHERE Department='' AND College='HP';
UPDATE work.roster SET College='COLLEGE-PUBL HLTH / HLTH PROFS' WHERE Department='REGISTRAR STUDENTS' AND College='HP';
UPDATE work.roster SET College='COLLEGE-VETERINARY MED' WHERE Department='VM-EMERGENCY MEDICINE' AND College='';
UPDATE work.roster SET College='DSO-SHANDS' WHERE Department='DSO-SHANDS' AND College='DSO-SHANDS';
UPDATE work.roster SET College='DSO-SHANDS' WHERE Department='AG-FOOD SCIENCE / HUMAN NUTR' AND College='';
UPDATE work.roster SET College='DSO-SHANDS' WHERE Department='UF HEALTH SHANDS TRAINING' AND College='DSO-SHANDS';
UPDATE work.roster SET College='INFORMATION TECHNOLOGY' WHERE Department='IT-AT ACADEMIC TECHNOLOGY' AND College='IT';
UPDATE work.roster SET College='OFFICE OF HEALTH AFFAIRS' WHERE Department='HA-STUDENT HEALTH CARE CENTER' AND College='HA';
UPDATE work.roster SET College='OFFICE OF RESEARCH' WHERE Department='' AND College='OR';
UPDATE work.roster SET College='OFFICE OF RESEARCH' WHERE Department='' AND College='RE';
UPDATE work.roster SET College='REGISTRAR STUDENTS' WHERE Department='REGISTRAR STUDENTS' AND College='OFFICE OF RESEARCH';

UPDATE work.roster SET College="" WHERE College IS NULL;


;
UPDATE work.roster SET College='COLLEGE-BUSINESS ADMINSTRATION' WHERE College='BU';
UPDATE work.roster SET College='GRADUATE SCHOOL' WHERE College='GR';
UPDATE work.roster SET College='REGISTRAR STUDENTS' WHERE College='Su';
UPDATE work.roster SET College='UF PRIVACY OFFICE' WHERE College='UF';

UPDATE work.roster SET College='COLLEGE- AGRICUL / NAT RES' WHERE DepartmentID='95015000' AND Department='AG-FOOD SCIENCE / HUMAN NUTR';
UPDATE work.roster SET College='COLLEGE-BUSINESS ADMINSTRATION' WHERE DepartmentID='17050100' AND Department='BA-ECONOMICS-BUSINESS OFFICE';
UPDATE work.roster SET College='COLLEGE-ENGINEERING' WHERE DepartmentID='19330100' AND Department='EG-PARTICLE ENG RES CTR';
UPDATE work.roster SET College='COLLEGE-LIBERAL ARTS/SCIENCES' WHERE DepartmentID='' AND Department='LS-CHEMISTRY-GENERAL';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE DepartmentID='' AND Department='MD-PULMONARY MEDICINE';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE DepartmentID='29011002' AND Department='MD-HEALTH CARE SUMMER INST';
UPDATE work.roster SET College='COLLEGE-MEDICINE' WHERE DepartmentID='29160200' AND Department='MD-RESIDENCY PROGRAM';
UPDATE work.roster SET College='COLLEGE-VETERINARY MED' WHERE DepartmentID='28092800' AND Department='VM-EMERGENCY MEDICINE';
UPDATE work.roster SET College='REGISTRAR STUDENTS' WHERE DepartmentID='ST010000' AND Department='REGISTRAR STUDENTS';


UPDATE work.roster SET College="" WHERE College ="OP";



/*
UPDATE work.roster
SET STD_PROGRAM='Research Subject Advocate'
WHERE STD_PROGRAM='Research Participant Advocate';


(SELECT * from work.roster
WHERE STD_PROGRAM="Regulatory Assistance" and 
YEAR=2016;

SELECT ORIG_PROGRAM,count(Distinct Person_key) as Users, Sum(Undup_Roster) as Roster from work.roster
WHERE STD_PROGRAM="REDCap"
AND Year IN ('2016','2015')
GROUP BY ORIG_PROGRAM;

UPDATE work.roster
SET STD_PROGRAM="ClinicalTrials.GOV"
WHERE ORIG_PROGRAM LIKE "ClincalTrials.gov%";

UPDATE work.roster
SET STD_PROGRAM="ClinicalTrials.GOV"
WHERE ORIG_PROGRAM LIKE "CT.gov%";

UPDATE work.roster
SET STD_PROGRAM="PubMed Compliance"
WHERE ORIG_PROGRAM LIKE "Pubmed%";

update work.roster
SET Orig_Program="xxPubMed Compliance"
WHERE STD_PROGRAM="Regulatory Assistance"
AND Year=2016
AND ORIG_PROGRAM='';

UPDATE work.roster
SET STD_PROGRAM="ClinicalTrials.GOV"
WHERE ORIG_PROGRAM LIKE "xxPubmed%";


UPDATE work.roster
SET ORIG_PROGRAM="xxClinicalTrials.GOV"
WHERE ORIG_PROGRAM LIKE "xxPubmed%";


SELECT STD_PROGRAM,ORIG_PROGRAM from work.roster WHERE STD_PROGRAM='IDE, IND Submission Assistance';



UPDATE work.roster
SET STD_PROGRAM='Regulatory Assistance'
WHERE STD_PROGRAM = 'IDE, IND Submission Assistance';


UPDATE work.roster
SET STD_PROGRAM='Integrated Data Repository'
WHERE STD_PROGRAM = 'Intergrated Data Repository';


UPDATE work.roster
SET STD_PROGRAM='Integrated Data Repository'
WHERE STD_PROGRAM = 'Intergrated Data Repository';



UPDATE work.roster
SET ORIG_PROGRAM='HealthStreet-Jacksonville'
WHERE STD_PROGRAM = 'HealthStreet-Jacksonville';

UPDATE work.roster
SET STD_PROGRAM='Communications'
WHERE STD_PROGRAM = 'COMR';

select distinct ORIG_PROGRAM from work.roster where STD_PROGRAM='Communications';

select distinct Orig_Program from work.roster where STD_PROGRAM="Community Engagement - Jacksonville";



SELECT ORIG_PROGRAM,count(Distinct Person_key) as Users, Sum(Undup_Roster) as Roster from work.roster
WHERE STD_PROGRAM="REDCap"
AND Year IN ('2016')
GROUP BY ORIG_PROGRAM;


UPDATE work.roster 
SET STD_PROGRAM='Integrated Data Repository',
    ORIG_PROGRAM="xxIDR"
WHERE STD_PROGRAM='REDCap' 
AND ORIG_PROGRAM=''
AND Roster=1
AND Year=2016;

UPDATE work.roster 
SET STD_PROGRAM='Integrated Data Repository',
    ORIG_PROGRAM="yyIDR"
WHERE STD_PROGRAM='REDCap' 
AND ORIG_PROGRAM=''
AND Roster=0
AND Year=2016;


select * from work.roster where
STD_PROGRAM IN ('CCTR','Health Outcomes and Policy')
;

select distinct Orig_Program from work.roster;
select distinct STD_Program from work.roster;

UPDATE work.roster SET STD_PROGRAM='Human Imaging' WHERE rosterid=15609;


*/
#############################################################
#############################################################
#############################################################
#############################################################
#############################################################
#############################################################

### Undup Roster Investigators
SELECT 	Year,
		Count(Distinct Person_Key) AS RosterInvest
From work.roster
Where Roster=1
group by Year;

###########################################################
### Unduplicated People served - All Users
SELECT 	Year,
		Count(Distinct Person_Key) AS RosterInvest
From work.roster
group by Year;
###########################################################
### MOST FREQ SERVICES PER YEAR ROSTER UNDUP
##XX

###########################################################
### MOST FREQ SERVICES PER YEAR All Users UNDUP
##XX


###########################################################
### Roster College by Year
##XX


###########################################################
### ALL Users  College by Year
##XX


###########################################################
###  DISTIBUTION OF Number of Services Used per Year Roster Undup


###########################################################
### DISTIBUTION OF Number of Services Used per Year ALL USERS Undup



###########################################################
###  SUPER USERS ACROSS YEARS Undup Roster Users
## Number of Services By Investigator

DROP TABLE IF EXISTS results.RosterSvcUsers;
Create table results.RosterSvcUsers AS
SELECT Person_key,
       max(LastName) As LastName,
       max(FirstName) AS FirstName,
       Count(DISTINCT STD_PROGRAM) AS nSVCUSED
from work.roster
WHERE Roster=1
group by Person_key
ORDER by nSVCUSED DESC;

select distinct STD_PROGRAM from work.roster where Person_Key='86692660';

select distinct STD_PROGRAM from work.roster where Person_Key='57131029';


###########################################################
###  SUPER USERS ACROSS YEARS Undup All Users






###########################################################
###########################################################
###########################################################
###########################################################
###########################################################
###########################################################
###########################################################
###########################################################
###########################################################
###########################################################
###########################################################
#################################################################################
#### CREATE COLLEGE REPORT
#################################################################################

drop table if Exists work.CollTable;
CREATE TABLE work.CollTable AS
SELECT DISTINCT College AS College
FROM work.roster;


ALTER TABLE work.CollTable
ADD Users_2009 integer(5),
ADD Users_2010 integer(5),
ADD Users_2011 integer(5),
ADD Users_2012 integer(5),
ADD Users_2013 integer(5),
ADD Users_2014 integer(5),
ADD Users_2015 integer(5),
ADD Users_2016 integer(5),
ADD Users_2017 integer(5),
ADD Users_AllYears integer(5),
ADD Roster_Users_2009 integer(5),
ADD Roster_Users_2010 integer(5),
ADD Roster_Users_2011 integer(5),
ADD Roster_Users_2012 integer(5),
ADD Roster_Users_2013 integer(5),
ADD Roster_Users_2014 integer(5),
ADD Roster_Users_2015 integer(5),
ADD Roster_Users_2016 integer(5),
ADD Roster_Users_2017 integer(5),
ADD Roster_Users_AllYears integer(5);


SET SQL_SAFE_UPDATES = 0;

UPDATE work.CollTable
SET Users_2009=0,
    Users_2010=0,
    Users_2011=0,
    Users_2012=0,
    Users_2013=0,
    Users_2014=0,
    Users_2015=0,
    Users_2016=0,
    Users_2017=0,
    Users_AllYears=0,
    Roster_Users_2009=0,
    Roster_Users_2010=0,
    Roster_Users_2011=0,
    Roster_Users_2012=0,
    Roster_Users_2013=0,
    Roster_Users_2014=0,
    Roster_Users_2015=0,
    Roster_Users_2016=0,
    Roster_Users_2017=0,
    Roster_Users_AllYears=0;


DROP TABLE IF EXISTS work.Collusers;
create table work.Collusers AS
select Year,College,count(distinct Person_key) AS UndupUsers
from work.roster
group by Year,College;

DROP TABLE IF EXISTS work.Collroster;
create table work.Collroster AS
select Year,College,count(distinct Person_key) AS UndupRoster
from work.roster
where Roster=1
group by Year,College;

DROP TABLE IF EXISTS work.AllCollusers;
create table work.AllCollusers AS
select College,count(distinct Person_key) AS UndupUsers
from work.roster
group by College;

DROP TABLE IF EXISTS work.AllCollroster;
create table  work.AllCollroster AS
select College,count(distinct Person_key) AS UndupUsers
from work.roster
Where Roster=1
group by College;


UPDATE work.CollTable pt, work.Collusers lu SET pt.Users_2009=UndupUsers WHERE lu.Year=2009 AND pt.College=lu.College;
UPDATE work.CollTable pt, work.Collusers lu SET pt.Users_2010=UndupUsers WHERE lu.Year=2010 AND pt.College=lu.College;
UPDATE work.CollTable pt, work.Collusers lu SET pt.Users_2011=UndupUsers WHERE lu.Year=2011 AND pt.College=lu.College;
UPDATE work.CollTable pt, work.Collusers lu SET pt.Users_2012=UndupUsers WHERE lu.Year=2012 AND pt.College=lu.College;
UPDATE work.CollTable pt, work.Collusers lu SET pt.Users_2013=UndupUsers WHERE lu.Year=2013 AND pt.College=lu.College;
UPDATE work.CollTable pt, work.Collusers lu SET pt.Users_2014=UndupUsers WHERE lu.Year=2014 AND pt.College=lu.College;
UPDATE work.CollTable pt, work.Collusers lu SET pt.Users_2015=UndupUsers WHERE lu.Year=2015 AND pt.College=lu.College;
UPDATE work.CollTable pt, work.Collusers lu SET pt.Users_2016=UndupUsers WHERE lu.Year=2016 AND pt.College=lu.College;
UPDATE work.CollTable pt, work.Collusers lu SET pt.Users_2017=UndupUsers WHERE lu.Year=2017 AND pt.College=lu.College;
UPDATE work.CollTable pt, work.AllCollusers lu SET pt.Users_AllYears=UndupUsers WHERE pt.College=lu.College;

UPDATE work.CollTable pt, work.Collroster lu SET pt.Roster_Users_2009=UndupRoster WHERE lu.Year=2009 AND pt.College=lu.College;
UPDATE work.CollTable pt, work.Collroster lu SET pt.Roster_Users_2010=UndupRoster WHERE lu.Year=2010 AND pt.College=lu.College;
UPDATE work.CollTable pt, work.Collroster lu SET pt.Roster_Users_2011=UndupRoster WHERE lu.Year=2011 AND pt.College=lu.College;
UPDATE work.CollTable pt, work.Collroster lu SET pt.Roster_Users_2012=UndupRoster WHERE lu.Year=2012 AND pt.College=lu.College;
UPDATE work.CollTable pt, work.Collroster lu SET pt.Roster_Users_2013=UndupRoster WHERE lu.Year=2013 AND pt.College=lu.College;
UPDATE work.CollTable pt, work.Collroster lu SET pt.Roster_Users_2014=UndupRoster WHERE lu.Year=2014 AND pt.College=lu.College;
UPDATE work.CollTable pt, work.Collroster lu SET pt.Roster_Users_2015=UndupRoster WHERE lu.Year=2015 AND pt.College=lu.College;
UPDATE work.CollTable pt, work.Collroster lu SET pt.Roster_Users_2016=UndupRoster WHERE lu.Year=2016 AND pt.College=lu.College;
UPDATE work.CollTable pt, work.Collroster lu SET pt.Roster_Users_2017=UndupRoster WHERE lu.Year=2017 AND pt.College=lu.College;
UPDATE work.CollTable pt, work.AllCollroster lu SET pt.Roster_Users_AllYears=UndupUsers WHERE pt.College=lu.College;


select * from work.CollTable;

Drop table if exists results.RosterCollegeTable;
CREATE Table results.RosterCollegeTable AS
select * from work.CollTable
ORDER BY Roster_Users_AllYears DESC;

SELECT College,
Roster_Users_2009,
Roster_Users_2010,
Roster_Users_2011,
Roster_Users_2012,
Roster_Users_2013,
Roster_Users_2014,
Roster_Users_2015,
Roster_Users_2016
from  work.CollTable;

##############################################################################


##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################


###Number of Services Used Per Year
DROP TABLE IF EXISTS work.RosterSvcUsersYR;
Create table work.RosterSvcUsersYR AS
SELECT Year,
       Person_key,
       max(LastName) As LastName,
       max(FirstName) AS FirstName,
       Count(DISTINCT STD_PROGRAM) AS nSVCUSED
from work.roster
WHERE Roster=1
group by Year,Person_key
ORDER by nSVCUSED DESC;

ALTER TABLE work.RosterSvcUsersYR
ADD Freq int(5);

UPDATE work.RosterSvcUsersYR set Freq=1;

DROP TABLE IF EXISTS results.RosterSvcYR;
Create table results.RosterSvcYR AS
Select  Year,  
        nSVCUSED,
        Sum(Freq) as Freq
from work.RosterSvcUsersYR
group by Year,  
        nSVCUSED
order by Year, nSVCUSED  DESC;


## UNDEFINED PROGRAMS
SELECT	ORIG_PROGRAM,
        Count(DISTINCT PERSON_KEY)
FROM work.roster 
WHERE STD_PROGRAM="Undefined"
##AND Roster=1

GROUP BY ORIG_PROGRAM;

##########################################################
##########################################################
##ADD FACULTY INDICATOR

/*
create table loaddata.bu_workroster20171108 AS
select  * from work.roster;

select Faculty,count(*) from work.roster group by Faculty;

drop table if exists work.titlefac;
create table work.titlefac as 
select Title,Faculty,count(*) from work.roster group by Title,Faculty;


drop table if exists work.titlefac2;
create table work.titlefac2 as 
select Title,Faculty,count(*) from work.facmap group by Title,Faculty;
*/
#### USE CREATED TABLE lookup.roster_faculty_type

ALTER TABLE work.roster
ADD FacType varchar(25);

UPDATE work.roster rs
SET rs.FacType="Non-Faculty";

UPDATE work.roster rs, lookup.roster_faculty_type lu
SET rs.FacType=lu.FacType
WHERE rs.Title=lu.Title;

############################# VERIFY
### NOTE SIMCENTER 2016 HAD 1000 No Title Particpants
### VERIFY BELOW
###
select * from work.roster where FacType IS Null and (Title="" or Title is Null);

select DISTINCT Title from work.roster where FacType IS Null;
select year,count(*) from work.roster where FacType IS Null group by Year;


select Employee_ID,Job_Code
from lookup.active_emp 
where Employee_ID IN 
(select Distinct UFID from work.roster where FacType IS Null)
GROUP BY Employee_ID,Job_Code;

select Distinct UFID from work.roster where FacType IS Null;


SELECT UF_UFID,UF_DISPLAY_NM,UF_WORK_TITLE 
from lookup.ufids
WHERE UF_UFID IN  (select Distinct UFID from work.roster where FacType IS Null)
GROUP BY UF_UFID,UF_DISPLAY_NM,UF_WORK_TITLE ;
###########################################################################

select YEAR,STD_PROGRAM,COUNT(*) from work.roster where FacType IS Null  group by YEAR,STD_PROGRAM;
select YEAR,STD_PROGRAM,COUNT(*) from work.roster where FacType IS Null and Roster=1 group by YEAR,STD_PROGRAM;


###############################################################################
##  Consolidate reporting Programs
select DISTINCT STD_PROGRAM FROM work.roster;

drop table if exists work.facchek;
create table work.facchek as
select Person_key,min(FacType) as fc1,max(FacType) as fc2 from work.roster group by Person_key;


select count(*) from work.facchek where fc1<>fc2;

drop table if exists work.factypecheck;
create table work.factypecheck as
select year,UFID,LastName,FirstName,Title,Person_key,FacType
from work.roster 
where Person_key in (select distinct Person_key from work.facchek where fc1<>fc2)
group by year,UFID,LastName,FirstName,Title,Person_key,FacType;


select * from lookup.active_emp where Employee_ID = '17969635';


create table loaddata.roster_bu_2017_11_10 AS select * from work.roster;

SET SQL_SAFE_UPDATES = 0;

UPDATE work.roster SET FacType='Assistant Professor'  WHERE Year='2016' AND Person_key='08450520';
UPDATE work.roster SET FacType='Assistant Professor' , Title='RES AST PROF'  WHERE Year='2017' AND Person_key='10892117';
UPDATE work.roster SET FacType='Assistant Professor'  WHERE Year='2017' AND Person_key='16370901';
UPDATE work.roster SET FacType='Assistant Professor'  WHERE Year='2015' AND Person_key='26143360';
UPDATE work.roster SET FacType='Assistant Professor'  WHERE Year='2016' AND Person_key='26143360';
UPDATE work.roster SET FacType='Assistant Professor'  WHERE Year='2011' AND Person_key='34189139';
UPDATE work.roster SET FacType='Assistant Professor'  WHERE Year='2012' AND Person_key='34189139';
UPDATE work.roster SET FacType='Assistant Professor'  WHERE Year='2013' AND Person_key='34189139';
UPDATE work.roster SET FacType='Assistant Professor'  WHERE Year='2014' AND Person_key='34189139';
UPDATE work.roster SET FacType='Assistant Professor'  WHERE Year='2015' AND Person_key='34189139';
UPDATE work.roster SET FacType='Assistant Professor'  WHERE Year='2016' AND Person_key='34189139';
UPDATE work.roster SET FacType='Assistant Professor'  WHERE Year='2017' AND Person_key='43429020';
UPDATE work.roster SET FacType='Assistant Professor'  WHERE Year='2016' AND Person_key='51212414';
UPDATE work.roster SET FacType='Assistant Professor' , Title='AST PROF'  WHERE Year='2016' AND Person_key='78114123';
UPDATE work.roster SET FacType='Associate Professor' , Title='ASO PROF'  WHERE Year='2017' AND Person_key='03202680';
UPDATE work.roster SET FacType='Associate Professor' , Title='Associate Professor'  WHERE Year='2017' AND Person_key='08430150';
UPDATE work.roster SET FacType='Associate Professor' , Title='ASO PROF'  WHERE Year='2017' AND Person_key='19618954';
UPDATE work.roster SET FacType='Associate Professor'  WHERE Year='2015' AND Person_key='21954984';
UPDATE work.roster SET FacType='Associate Professor'  WHERE Year='2016' AND Person_key='21954984';
UPDATE work.roster SET FacType='Associate Professor'  WHERE Year='2017' AND Person_key='26143360';
UPDATE work.roster SET FacType='Associate Professor'  WHERE Year='2017' AND Person_key='44452400';
UPDATE work.roster SET FacType='Associate Professor'  WHERE Year='2011' AND Person_key='84834933';
UPDATE work.roster SET FacType='Associate Professor'  WHERE Year='2014' AND Person_key='84834933';
UPDATE work.roster SET FacType='Associate Professor'  WHERE Year='2015' AND Person_key='84834933';
UPDATE work.roster SET FacType='Associate Professor'  WHERE Year='2016' AND Person_key='84834933';
UPDATE work.roster SET FacType='Associate Professor' , Title='ASO PROF&AST DN'  WHERE Year='2014' AND Person_key='Ainsworth-Lisa';
UPDATE work.roster SET FacType='Associate Professor' , Title='ASO PROF'  WHERE Year='2011' AND Person_key='Coleman-Beverly L';
UPDATE work.roster SET FacType='Associate Professor' , Title='ASO PROF'  WHERE Year='2011' AND Person_key='Currington-Cheryl';
UPDATE work.roster SET FacType='Associate Professor' , Title='ASO PROF'  WHERE Year='2014' AND Person_key='Dukhovny-Dmitry';
UPDATE work.roster SET FacType='Associate Professor' , Title='ASO PROF'  WHERE Year='2013' AND Person_key='Gardell-Stephen';
UPDATE work.roster SET FacType='Associate Professor' , Title='ASO PROF'  WHERE Year='2014' AND Person_key='Gardell-Stephen';
UPDATE work.roster SET FacType='Associate Professor' , Title='ASO PROF'  WHERE Year='2011' AND Person_key='Klee-Kenyatta';
UPDATE work.roster SET FacType='Associate Professor' , Title='ASO PROF'  WHERE Year='2011' AND Person_key='Olitsky-Darla Robertson';
UPDATE work.roster SET FacType='Associate Professor' , Title='ASO PROF'  WHERE Year='2011' AND Person_key='Salathe-Matthias A';
UPDATE work.roster SET FacType='Associate Professor' , Title='ASO PROF'  WHERE Year='2011' AND Person_key='Schwenk-Garner-Krista';
UPDATE work.roster SET FacType='Associate Professor' , Title='ASO PROF'  WHERE Year='2015' AND Person_key='Szapocznik-Jose';
UPDATE work.roster SET FacType='Associate Professor' , Title='ASO PROF'  WHERE Year='2014' AND Person_key='Wolf-Shannon';
UPDATE work.roster SET FacType='Non-Faculty'  WHERE Year='2017' AND Person_key='00627180';
UPDATE work.roster SET FacType='Non-Faculty'  WHERE Year='2017' AND Person_key='00737560';
UPDATE work.roster SET FacType='Non-Faculty'  WHERE Year='2014' AND Person_key='17969635';
UPDATE work.roster SET FacType='Non-Faculty'  WHERE Year='2016' AND Person_key='17969635';
UPDATE work.roster SET FacType='Non-Faculty'  WHERE Year='2017' AND Person_key='20691170';
UPDATE work.roster SET FacType='Non-Faculty'  WHERE Year='2015' AND Person_key='54659069';
UPDATE work.roster SET FacType='Non-Faculty'  WHERE Year='2016' AND Person_key='54659069';
UPDATE work.roster SET FacType='Non-Faculty'  WHERE Year='2014' AND Person_key='89011145';
UPDATE work.roster SET FacType='Non-Faculty'  WHERE Year='2015' AND Person_key='89011145';
UPDATE work.roster SET FacType='Non-Faculty'  WHERE Year='2016' AND Person_key='89011145';
UPDATE work.roster SET FacType='Professor'  WHERE Year='2017' AND Person_key='02331841';
UPDATE work.roster SET FacType='Professor'  WHERE Year='2017' AND Person_key='06031259';
UPDATE work.roster SET FacType='Professor'  WHERE Year='2017' AND Person_key='14547450';
UPDATE work.roster SET FacType='Professor' , Title='CLIN PROF'  WHERE Year='2017' AND Person_key='24449580';
UPDATE work.roster SET FacType='Professor'  WHERE Year='2017' AND Person_key='24888999';
UPDATE work.roster SET FacType='Professor'  WHERE Year='2017' AND Person_key='27689940';
UPDATE work.roster SET FacType='Professor'  WHERE Year='2017' AND Person_key='38103241';
UPDATE work.roster SET FacType='Professor'  WHERE Year='2017' AND Person_key='38103241';
UPDATE work.roster SET FacType='Professor'  WHERE Year='2017' AND Person_key='51427982';
UPDATE work.roster SET FacType='Professor'  WHERE Year='2017' AND Person_key='52462210';
UPDATE work.roster SET FacType='Professor'  WHERE Year='2009' AND Person_key='57131029';
UPDATE work.roster SET FacType='Professor'  WHERE Year='2010' AND Person_key='57131029';
UPDATE work.roster SET FacType='Professor'  WHERE Year='2011' AND Person_key='57131029';
UPDATE work.roster SET FacType='Professor'  WHERE Year='2012' AND Person_key='57131029';
UPDATE work.roster SET FacType='Professor'  WHERE Year='2013' AND Person_key='57131029';
UPDATE work.roster SET FacType='Professor'  WHERE Year='2014' AND Person_key='57131029';
UPDATE work.roster SET FacType='Professor'  WHERE Year='2015' AND Person_key='57131029';
UPDATE work.roster SET FacType='Professor'  WHERE Year='2016' AND Person_key='57131029';
UPDATE work.roster SET FacType='Professor' , Title='Graduate Research Assistant'  WHERE Year='2017' AND Person_key='69154467';



UPDATE work.roster SET FacType='Assistant Professor'  WHERE Year='2017' AND Person_key='69895951';
UPDATE work.roster SET FacType='Associate Professor' , Title='ASSOCIATE PROFESSOR'  WHERE Year='2017' AND Person_key='77560740';
UPDATE work.roster SET FacType='Associate Professor' , Title='ASSOCIATE PROFESSOR'  WHERE Year='2014' AND Person_key='Delp-Judy';
UPDATE work.roster SET FacType='Associate Professor' , Title='ASSOCIATE PROFESSOR'  WHERE Year='2010' AND Person_key='Salathe-Matthias A';
UPDATE work.roster SET FacType='Non-Faculty'  WHERE Year='2017' AND Person_key='69154467';
UPDATE work.roster SET FacType='Professor'  WHERE Year='2017' AND Person_key='01237170';
UPDATE work.roster SET FacType='Professor'  WHERE Year='2017' AND Person_key='23804381';

###############################################################################
########### READD KLTL AND MENTOR ACAD

select year,person_key,LastName,FirstName,STD_PROGRAM,FacType from work.roster where STD_PROGRAM="KL TL";

select distinct Std_Programs from work.roster;

#################################################################################
###MENTOR ACAD


UPDATE lookup.roster 
set STD_PROGRAM="Clinical Research Professionals Advisory Council" 
WHERE STD_PROGRAM="Clinical Research Prof Advisory Council";

UPDATE work.roster 
set STD_PROGRAM="Clinical Research Professionals Advisory Council" 
WHERE STD_PROGRAM="Clinical Research Prof Advisory Council";


SELECT TITLE,FacType
WHERE FacType="
